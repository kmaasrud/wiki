<!DOCTYPE HTML>
<html color-mode="light">
<head>
<title>Ordinary least squares regression - kmaasrud's wiki</title>
<meta charset="UTF-8">
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="theme-color" content="#ffffff" />

<!-- Normalize -->
<link rel="stylesheet" href="./css/normalize.min.css">
<!-- Prism -->
<link rel="stylesheet" href="./css/prism.min.css">
<script src="./js/prism.min.js"></script>
<!-- KaTeX -->
<link rel="stylesheet" href="./css/katex.min.css">
<script src="./js/katex.min.js"></script>
<script src="./js/auto-render.min.js"></script>
<script>
document.addEventListener("DOMContentLoaded", function() {
renderMathInElement(document.body, {
delimiters: [
{left: '$$', right: '$$', display: true},
{left: '$', right: '$', display: false},
{left: '\\(', right: '\\)', display: false},
{left: '\\[', right: '\\]', display: true}
],
});
});
</script>
<!-- mdzk stylesheet -->
<link rel="stylesheet" href="./css/mdzk.css">
</head>
<body>

<label id="theme-switch" class="theme-switch" for="checkbox_theme">
<input type="checkbox" id="checkbox_theme">
<span></span>
</label>

<main>
<header>

<h1>
<a href="./index.html">~</a>
Ordinary least squares regression
</h1>
</header>
<article>
<p><strong>Ordinary least squares</strong> (OLS) is a method of estimating the parameters in a <a href="Linear%20regression.html">linear regression</a> model.</p>
<p>We have a dataset of $n$ observations $(y_i, \mathbf x_i)$, where $\mathbf x_i$ are the column vectors of length $p$ containing the parameters and $y_i$ are the scalar responses. We set up the linear function for the $i$’th case as</p>
<p>$$ y_i = \beta_1 x_{i1} + \beta_2 x_{i2} + \dots + \beta_p x_{ip} + \epsilon_i,$$</p>
<p>$$ y_i = \mathbf x^T_i\beta + \epsilon_i .$$</p>
<p>Here $\beta$ is an unknown $p\times 1$ vector and $\epsilon_i$ is the error of the model in the $i$’th case. So for all $i$ cases, we write the total equation on matrix form as</p>
<p>$$ \mathbf y = \mathbf X\mathbf \beta + \mathbf \epsilon ,$$</p>
<p>with $\mathbf X$ being an $n\times p$ matrix, often called the <em>design matrix</em> or <em>matrix of regressors</em>. It’s worth noting that - contrary to what one might think - the $i$’th <strong>row</strong> of $\mathbf X$ equals $\mathbf x_i^T$. Also, the constant term is included in our equation by setting $x_{i1} = 1\ \forall\ i=1,\dots, n$.</p>
<p>Now because of the errors, $\mathbf y = \mathbf X\mathbf \beta$ does not have a unique solution. However, we can find the best fit by finding the vector $\hat \beta$ that minimizes some sort of <a href="Cost%20function.html">cost function</a>,</p>
<p>$$ \hat \beta = \underset{\beta}{\arg \min} S(\beta) .$$</p>
<p>$\hat \beta$ will give us an estimate of $\mathbf y$, namely $\hat{\mathbf y} = \mathbf X \hat \beta$. In the case of OLS, the <a href="Cost%20function.html">cost function</a> we use is the</p>
<p>$$ \text{RSS}(\beta) = \sum_{i=1}^N \left(y_i - \hat y_i\right)^2 .$$</p>
<p>Changing into matrix notation again, we get</p>
<p>$$ \text{RSS}(\beta) = (\mathbf y - \hat{\mathbf y})^T(\mathbf y - \hat{\mathbf y}) = (\mathbf y  - \mathbf X\beta)^T(\mathbf y - \mathbf X\beta) ,$$</p>
<p>which we can differentiate with respect to $\beta$ to find the minimum.</p>
<p>$$ \frac{\partial \text{RSS}}{\partial \beta} = -2\mathbf X^T (\mathbf y - \mathbf X\beta) .$$</p>
<p>Assuming <a href="Rank.html">full column rank</a> for $\mathbf X$, $(\mathbf X^T \mathbf X)$ is thus positive definite (and importantly, invertible). Setting the first derivative to $0$, we get<sup class="footnote-reference"><a href="#elements">1</a></sup>:</p>
<p>$$ \mathbf X^T(\mathbf y - \mathbf X\beta) = 0$$</p>
<p>$$\Rightarrow \hat \beta = (\mathbf X^T\mathbf X)^{-1}\mathbf X^T \mathbf y $$</p>
<div class="footnote-definition" id="elements"><sup class="footnote-definition-label">1</sup>
<p><a href="bib/The%20elements%20of%20statistical%20learning.html">The elements of statistical learning</a></p>
</div>

</article>
<footer>

<div class="incoming-links">
<h3>Incoming links</h3>
<p>

<a href="Ridge regression.html">Ridge regression</a>

<a href="Linear regression.html">Linear regression</a>

</p>
</div>

</footer>
</main>
<p class="watermark">Page made with <a href="https://mdzk.app">mdzk</a></p>

<script>
// Determines if the user has a set theme
function detectColorScheme(){
var theme="light"; // default to light
// Local storage is used to override OS theme settings
if (localStorage.getItem("color-mode")) {
if (localStorage.getItem("color-mode") == "dark") {
var theme = "dark";
}
} else if (!window.matchMedia) {
// matchMedia method not supported
return false;
} else if (window.matchMedia("(prefers-color-scheme: dark)").matches) {
// OS theme setting detected as dark
var theme = "dark";
}
// Dark theme preferred, set document with a `data-theme` attribute
if (theme == "dark") {
document.documentElement.setAttribute("color-mode", "dark");
}
}
detectColorScheme();
// Identify the toggle switch HTML element
const toggleSwitch = document.querySelector('#theme-switch input[type="checkbox"]');
// Function that changes the theme, and sets a localStorage variable to track the theme between page loads
function switchTheme(e) {
if (e.target.checked) {
localStorage.setItem("color-mode", "dark");
document.documentElement.setAttribute("color-mode", "dark");
toggleSwitch.checked = true;
} else {
localStorage.setItem("color-mode", "light");
document.documentElement.setAttribute("color-mode", "light");
toggleSwitch.checked = false;
}
}
// Listener for changing themes
toggleSwitch.addEventListener('click', switchTheme, false);
// Pre-check the dark-theme checkbox if dark-theme is set
if (document.documentElement.getAttribute("color-mode") == "dark"){
toggleSwitch.checked = true;
}
</script>

</body>
</html>